{% load static %}

<!doctype html>
<html lang="ko">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">

  <!-- 구글 머티리얼 아이콘 -->
  <link
    href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
    rel="stylesheet">

	<!-- 제이쿼리 -->
	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<link href="{% static 'Python_Insta_2/CSS_File/main_css.css' %}" rel="stylesheet">
  <title>Instagram </title>
</head>



<body>

<!-- 상단 내비게이션 바 -->
<nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom" style="width: 100%;height: 50px;position: fixed;" >
  <div class="container">
    <img style="height: 30px; object-fit: contain"
         src="https://www.instagram.com/static/images/web/mobile_nav_type_logo-2x.png/1b47f9d0e595.png">
    <input class="form-control" style="width: 200px" type="search" placeholder="Search" aria-label="Search">
    <div>
      <span class="material-icons">home</span>
      <span class="material-icons">send</span>
      <span id="nav_bar_add_box" class="material-icons-outlined">add_box</span>
      <span class="material-icons-outlined">explore</span>
      <span class="material-icons-outlined">favorite_border</span>
    </div>
  </div>
</nav>

<!-- 바디 영역 -->
<div class="main_body">
  <div class="left_body">
	  {% for feed in feeds %}

    <div class="border feed_box">
      <div class="feed_name">
        <div class="profile_box">
          <img class="profile_img" src="{{feed.profile_image.url }}">
        </div>
        <span class="feed_name_txt"> {{ feed.user_id }} </span>
      </div>
      <img class="feed_img" src="{{ feed.image.url }}">


      <div class="feed_icon">
        <div>
          <span class="material-icons-outlined">
            favorite_border
          </span>
          <span class="material-icons-outlined">
            mode_comment
          </span>
          <span class="material-icons-outlined">
            send
          </span>
        </div>
        <div>
          <span class="material-icons-outlined">
            turned_in_not
          </span>
        </div>
      </div>
      <div class="feed_like">
        <p class="feed_txt"> <b>좋아요 {{ feed.like_count }}개</b></p>
      </div>
      <div class="feed_content">
        <p class="feed_txt"> <b> {{ feed.user_id }} </b> {{ feed.content }}</p>
      </div>
      <div class="feed_reply">
        <span class="feed_txt"> <b> mychew </b> 댓글1</span>
        <span class="feed_txt"> <b> cho </b> 댓글2 </span>
      </div>
    </div>
    {% endfor %}


	<!--- 오른쪽  --->
  <div class="right_body">
    <div class="feed_name" style="justify-content: space-between">
      <div style="display: flex; align-items: center; ">
        <div class="big_profile_box">
          <img class="profile_img"
               src="https://scontent-ssn1-1.xx.fbcdn.net/v/t1.6435-9/s1080x2048/165180104_277246477102900_6106347261862438192_n.jpg?_nc_cat=102&ccb=1-5&_nc_sid=730e14&_nc_ohc=1sN4d8i7rn8AX-7aKYN&_nc_ht=scontent-ssn1-1.xx&oh=5049b7cd176848e330b0f5ea95f28172&oe=615A08D1">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> jin.99 </span>
          <span class="name_content_txt"> Moon Kyujin</span>
        </div>
      </div>

      <a class="link_txt" >
        전환
      </a>
    </div>

    <div class="recommend_box">
      <span style="color: gray"> 회원님을 위한 추천</span>
      <span style="font-size: 12px"> 모두 보기 </span>
    </div>
    <div>
      <div class="feed_name" style="justify-content: space-between">
        <div class="profile_box">
          <img class="profile_img"
               src="https://i.pinimg.com/736x/93/a6/8b/93a68b57a54e4bdc73d43d1d049b94b3.jpg">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> dation3388 </span>
          <span class="name_content_txt"> Jinstargram 신규가입</span>
        </div>
        <a class="link_txt">
          팔로우
        </a>
      </div>
      <div class="feed_name" style="justify-content: space-between">
        <div class="profile_box">
          <img class="profile_img"
               src="http://file3.instiz.net/data/cached_img/upload/2021/01/27/18/2ce2f41f7e9f09c0acc77faac7452dbf.jpg">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> gaoudi </span>
          <span class="name_content_txt"> IU 외 5명이 팔로우</span>
        </div>
        <a class="link_txt">
          팔로우
        </a>
      </div>
      <div class="feed_name" style="justify-content: space-between">
        <div class="profile_box">
          <img class="profile_img"
               src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTTiCVWdogd6Ocsm08kL8ph4sb1MN0AYEiSUQ&usqp=CAU">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> CAU </span>
          <span class="name_content_txt"> IU 외 5명이 팔로우</span>
        </div>
        <a class="link_txt">
          팔로우
        </a>
      </div>
      <div class="feed_name" style="justify-content: space-between">
        <div class="profile_box">
          <img class="profile_img"
               src="https://pbs.twimg.com/media/EhzH0_DU4AEZ9yr.jpg">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> 123456789 </span>
          <span class="name_content_txt"> 그냥 추천해봄 </span>
        </div>
        <a class="link_txt">
          팔로우
        </a>
      </div>
      <div class="feed_name" style="justify-content: space-between">
        <div class="profile_box">
          <img class="profile_img"
               src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQHPNYM5RQgA2F7BtpBQ-OrNFKDXVDUpypRuw&usqp=CAU">
        </div>
        <div class="name_content">
          <span class="feed_name_txt"> instiz </span>
          <span class="name_content_txt"> 애도 유명해 </span>
        </div>
        <a class="link_txt">
          팔로우
        </a>
      </div>
    </div>
    <div class="comment_box">
      <span> 인스타그램 클론 코딩 </span>
      <span> https://cholol.tistory.com </span>
      <br>
      <span> @2021 Jin.99 </span>

    </div>
  </div>
</div>
<!-- 모달 팝업, overlay는 뒤에있는 창, window는 현재 보여지는 창-->
<!-- 첫번째모달  -->
    <div id="first_modal" class="modal_overlay">
        <div class="modal_window">
	        <!-- 3부분으로 나눠야 뒷부분 X를 넣을수있음 -->
	        <div style=" display: flex;flex-direction: row;justify-content: space-between">
		        <!-- 앞부분(공백) -->
		        <div style="width: 40px;">
			        &nbsp
		        </div>
		        <!-- 이미지 업로드 -->
		        <div>
			        새 이미지 업로드
		        </div>
		        <!-- X표시 -->
		        <div style="width: 40px;">
			        <span class="material-icons-outlined">close</span>
		        </div>
        </div>
	        <!-- 이미지 업로드 부분 -->
	        <div class="img_upload_space" style="width: 778px; height: 540px;margin-top:10px; background-color: wheat">

	        </div>
    </div>
</div>
<!-- 두번째 모달  -->
   <div id="second_modal" class="modal_overlay">
        <div class="modal_window">
	        <!-- 3부분으로 나눠야 뒷부분 X를 넣을수있음 -->
	        <div style="display: flex;flex-direction: row;justify-content: space-between">
		        <!-- 앞부분(공백) -->
		        <div style="width: 40px;">
			        &nbsp
		        </div>
		        <!-- 이미지 업로드 -->
		        <div>
			        새 이미지 업로드
		        </div>
		        <!-- X표시 -->
		        <div style="width: 40px;">
			        <span class="material-icons-outlined">close</span>
		        </div>
        </div>
	        <div style="display: flex; flex-direction: row; border-top: solid 1px gray; margin-top: 10px;">
		        <!-- 이미지 업로드 부분 -->
	        <div class="img_upload_space" style="width: 500px; height: 540px;margin-top:10px; background-color: wheat">

	        </div>
		        <div style="border-left: solid 1px gray">
			        <div style="width: 276px; height: 400px;">
				        <textarea id="input_feed_content" class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
			        </div>
			        <button id="feed_create_button" type="button" class="btn btn-primary" style="width: 100%;margin-top: 10px;">
				        공유하기
			        </button>
		        </div>
	        </div>

    </div>
</div>



</div>
<!-- JS File -->
<!-- 모달, 스크롤바 숨기기  -->
<script>
	let files;
	$('#nav_bar_add_box').click(function () {
       $('#first_modal').css({
	       display: 'flex'
       })
		$(document.body).css({
			overflow_y: 'hidden'
		})

    });

<!-- 드래그앤 드랍-->
	<!-- 드래그시 뒷 배경 제어 차단 dragover/ dragleave-->
	$('#feed_create_button').click(function () {
       alert('공유하기 눌렀다.');

       let file = files[0];
       let image = files[0].name;
       let content = $('#input_feed_content').val();
       let user_id = 'id2222';
       let profile_image = 'https://i.pinimg.com/736x/93/a6/8b/93a68b57a54e4bdc73d43d1d049b94b3.jpg';

       let fd = new FormData();
       fd.append('file', file);
       fd.append('image', image);
       fd.append('content', content);
       fd.append('user_id', user_id);
       fd.append('profile_image', profile_image);

      $.ajax({
            url: "/content/upload",
            data: fd,
            method: "POST",
            processData: false,
            contentType: false,
            success: function (data) {
                console.log("성공");
            },
            error: function (request, status, error) {
                console.log("에러");
            },
            complete: function() {
                console.log("완료");
                location.replace("/main");
            }
        })
    });

    $('.img_upload_space')
        .on("dragover", dragOver)
        .on("dragleave", dragOver)
        .on("drop", uploadFiles);

    function dragOver(e){
        e.stopPropagation();
        e.preventDefault();

        if (e.type == "dragover") {
            $(e.target).css({
                "background-color": "black",
                "outline-offset": "-20px"
            });
        } else {
            $(e.target).css({
                "background-color": "orange",
                "outline-offset": "-10px"
            });
        }
    }

    function uploadFiles(e){
        e.stopPropagation();
        e.preventDefault();

        e.dataTransfer = e.originalEvent.dataTransfer;
	    files =  e.dataTransfer.files;

        if (files.length > 1) {
            alert('이미지 하나만 가능.');
            return;
        }

        if (files[0].type.match(/image.*/)) {
            $('#first_modal').css({
	            "display": "none"
            });
            $('#second_modal').css({
	            "display": "flex"
            });


            $('.img_upload_space').css({
                "background-image": "url(" + window.URL.createObjectURL(files[0]) + ")",
                "outline": "none",
                "background-size": "100% 100%",
	            "background-repeat": "no-repeat",
	            "background-position": "center center",

            });
        }else{
            alert('이미지가 아님');
            return;
        }

    }



</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
        crossorigin="anonymous"></script>



</body>
</html>


